openapi: 3.0.3
info:
  title: Jotty API
  description: |
    Programmatic access to your checklists and notes with full CRUD operations.

    ## Authentication
    All endpoints require authentication via API key in the `x-api-key` header.

    Get your API key from: Profile → Settings → API Key → Generate
  version: "1.0.0"
  contact:
    name: Jotty
    url: https://github.com/fccview/jotty

security:
  - ApiKeyAuth: []

paths:
  /health:
    get:
      summary: Health Check
      description: Returns the application health status and version information
      tags:
        - System
      security: []  # Public endpoint
      responses:
        '200':
          description: Application is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy, unhealthy]
                    example: healthy
                  version:
                    type: string
                    example: "1.9.3"
                  timestamp:
                    type: string
                    format: date-time
                    example: "2025-10-31T21:15:57.009Z"
                  error:
                    type: string
                    description: Only present when status is unhealthy

  /checklists:
    get:
      summary: Get All Checklists
      description: Retrieves all checklists for the authenticated user. Supports filtering and search.
      tags:
        - Checklists
      parameters:
        - name: category
          in: query
          schema:
            type: string
          description: Filter checklists by category
        - name: type
          in: query
          schema:
            type: string
            enum: [simple, task]
          description: Filter checklists by type
        - name: q
          in: query
          schema:
            type: string
          description: Search checklists by title or item text
      responses:
        '200':
          description: List of checklists
          content:
            application/json:
              schema:
                type: object
                properties:
                  checklists:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
                        title:
                          type: string
                          example: "My Tasks"
                        category:
                          type: string
                          example: "Work"
                        type:
                          type: string
                          enum: [simple, task]
                          example: "simple"
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/ChecklistItem'
                        createdAt:
                          type: string
                          format: date-time
                        updatedAt:
                          type: string
                          format: date-time

    post:
      summary: Create Checklist
      description: Creates a new checklist for the authenticated user
      tags:
        - Checklists
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  example: "My New Checklist"
                category:
                  type: string
                  default: "Uncategorized"
                  example: "Work"
                type:
                  type: string
                  enum: [simple, task]
                  default: simple
                  example: "simple"
      responses:
        '200':
          description: Checklist created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      category:
                        type: string
                      type:
                        type: string
                      items:
                        type: array
                        items: {}
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
        '400':
          description: Invalid request (missing title or invalid type)

  /checklists/{listId}/items:
    post:
      summary: Create Checklist Item
      description: |
        Adds a new item to the specified checklist.

        To create a nested item, provide the `parentIndex` parameter with the index path of the parent item (e.g., "0" for first item's child, "0.1" for second child of first item).
      tags:
        - Checklists
      parameters:
        - name: listId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the checklist
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  example: "New task to complete"
                parentIndex:
                  type: string
                  description: Index path of parent item (e.g., "0", "0.1", "2.0.1") for creating nested sub-items
                  example: "0"
                status:
                  type: string
                  enum: [in_progress, paused, completed]
                  default: in_progress
                time:
                  oneOf:
                    - type: integer
                      default: 0
                    - type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                          startTime:
                            type: string
                            format: date-time
                          endTime:
                            type: string
                            format: date-time
                          duration:
                            type: integer
      responses:
        '200':
          description: Item created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Checklist not found
        '400':
          description: Invalid request

  /checklists/{listId}/items/{itemIndex}/check:
    put:
      summary: Mark Item as Completed
      description: |
        Marks a checklist item as completed.

        Supports nested items using index paths (e.g., "0" for first item, "0.1" for second child of first item, "2.0.1" for nested grandchild).
      tags:
        - Checklists
      parameters:
        - name: listId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: itemIndex
          in: path
          required: true
          schema:
            type: string
          description: Index or index path (e.g., "0", "0.1", "2.0.1")
          example: "0.1"
      responses:
        '200':
          description: Item marked as completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Checklist or item not found
        '400':
          description: Invalid item index

  /checklists/{listId}/items/{itemIndex}/uncheck:
    put:
      summary: Mark Item as Incomplete
      description: |
        Marks a checklist item as incomplete.

        Supports nested items using index paths (e.g., "0" for first item, "0.1" for second child of first item, "2.0.1" for nested grandchild).
      tags:
        - Checklists
      parameters:
        - name: listId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: itemIndex
          in: path
          required: true
          schema:
            type: string
          description: Index or index path (e.g., "0", "0.1", "2.0.1")
          example: "0.1"
      responses:
        '200':
          description: Item marked as incomplete
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Checklist or item not found
        '400':
          description: Invalid item index

  /checklists/{listId}/items/{itemIndex}:
    delete:
      summary: Delete Item
      description: |
        Deletes a checklist item.

        Supports nested items using index paths (e.g., "0" for first item, "0.1" for second child of first item, "2.0.1" for nested grandchild).
      tags:
        - Checklists
      parameters:
        - name: listId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: itemIndex
          in: path
          required: true
          schema:
            type: string
          description: Index or index path (e.g., "0", "0.1", "2.0.1")
          example: "1"
      responses:
        '200':
          description: Item deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Checklist or item not found
        '400':
          description: Invalid item index

  /notes:
    get:
      summary: Get All Notes
      description: Retrieves all notes for the authenticated user. Supports filtering and search.
      tags:
        - Notes
      parameters:
        - name: category
          in: query
          schema:
            type: string
          description: Filter notes by category
        - name: q
          in: query
          schema:
            type: string
          description: Search notes by title or content
      responses:
        '200':
          description: List of notes
          content:
            application/json:
              schema:
                type: object
                properties:
                  notes:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                          example: "6ba7b810-9dad-11d1-80b4-00c04fd430c8"
                        title:
                          type: string
                          example: "My Note"
                        category:
                          type: string
                          example: "Personal"
                        content:
                          type: string
                          description: Markdown content
                          example: "Note content here..."
                        createdAt:
                          type: string
                          format: date-time
                        updatedAt:
                          type: string
                          format: date-time

    post:
      summary: Create Note
      description: Creates a new note for the authenticated user
      tags:
        - Notes
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  example: "My New Note"
                content:
                  type: string
                  description: Markdown content
                  example: "Note content here..."
                category:
                  type: string
                  default: "Uncategorized"
                  example: "Personal"
      responses:
        '200':
          description: Note created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      content:
                        type: string
                      category:
                        type: string
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
                      owner:
                        type: string
        '400':
          description: Invalid request (missing title)

  /notes/{noteId}:
    put:
      summary: Update Note
      description: Updates an existing note. All fields are optional - unspecified fields will preserve their current values.
      tags:
        - Notes
      parameters:
        - name: noteId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the note to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: "Updated Note Title"
                content:
                  type: string
                  description: Markdown content
                  example: "Updated note content..."
                category:
                  type: string
                  example: "Work"
      responses:
        '200':
          description: Note updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      content:
                        type: string
                      category:
                        type: string
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
                      owner:
                        type: string
        '404':
          description: Note not found
        '400':
          description: Invalid request

    delete:
      summary: Delete Note
      description: Deletes an existing note
      tags:
        - Notes
      parameters:
        - name: noteId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the note to delete
      responses:
        '200':
          description: Note deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Note not found

  /tasks:
    get:
      summary: Get All Tasks
      description: Retrieves all task checklists for the authenticated user. Supports filtering and search.
      tags:
        - Tasks
      parameters:
        - name: category
          in: query
          schema:
            type: string
          description: Filter tasks by category
        - name: status
          in: query
          schema:
            type: string
          description: Filter tasks that contain items with this status
        - name: q
          in: query
          schema:
            type: string
          description: Search tasks by title or item text
      responses:
        '200':
          description: List of tasks
          content:
            application/json:
              schema:
                type: object
                properties:
                  tasks:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
                        title:
                          type: string
                          example: "Sprint Tasks"
                        category:
                          type: string
                          example: "Work"
                        statuses:
                          type: array
                          items:
                            $ref: '#/components/schemas/KanbanStatus'
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/ChecklistItem'
                        createdAt:
                          type: string
                          format: date-time
                        updatedAt:
                          type: string
                          format: date-time

    post:
      summary: Create Task
      description: Creates a new task checklist for the authenticated user
      tags:
        - Tasks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  example: "New Sprint"
                category:
                  type: string
                  default: "Uncategorized"
                  example: "Work"
                statuses:
                  type: array
                  items:
                    $ref: '#/components/schemas/KanbanStatus'
                  description: Custom Kanban statuses (defaults to todo/in_progress/completed)
      responses:
        '200':
          description: Task created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      category:
                        type: string
                      statuses:
                        type: array
                        items:
                          $ref: '#/components/schemas/KanbanStatus'
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/ChecklistItem'
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
        '400':
          description: Invalid request

  /tasks/{taskId}:
    get:
      summary: Get Task
      description: Retrieves a specific task checklist
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
      responses:
        '200':
          description: Task details
          content:
            application/json:
              schema:
                type: object
                properties:
                  task:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      category:
                        type: string
                      statuses:
                        type: array
                        items:
                          $ref: '#/components/schemas/KanbanStatus'
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/ChecklistItem'
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
        '404':
          description: Task not found
        '400':
          description: Not a task checklist

    put:
      summary: Update Task
      description: Updates task metadata (title, category). All fields are optional.
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: "Updated Sprint Title"
                category:
                  type: string
                  example: "Work"
      responses:
        '200':
          description: Task updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      category:
                        type: string
                      statuses:
                        type: array
                        items:
                          $ref: '#/components/schemas/KanbanStatus'
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
        '404':
          description: Task not found
        '400':
          description: Invalid request or not a task checklist

    delete:
      summary: Delete Task
      description: Deletes a task checklist
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task to delete
      responses:
        '200':
          description: Task deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Task not found
        '400':
          description: Not a task checklist

  /tasks/{taskId}/statuses:
    get:
      summary: Get Task Statuses
      description: Retrieves all Kanban column statuses for a task
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
      responses:
        '200':
          description: List of statuses
          content:
            application/json:
              schema:
                type: object
                properties:
                  statuses:
                    type: array
                    items:
                      $ref: '#/components/schemas/KanbanStatus'
        '404':
          description: Task not found
        '400':
          description: Not a task checklist

    post:
      summary: Create Status
      description: Adds a new Kanban column status to a task
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - label
              properties:
                id:
                  type: string
                  example: "review"
                label:
                  type: string
                  example: "In Review"
                color:
                  type: string
                  example: "#3b82f6"
                order:
                  type: integer
                  example: 2
      responses:
        '200':
          description: Status created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/KanbanStatus'
        '400':
          description: Invalid request or status ID already exists
        '404':
          description: Task not found

  /tasks/{taskId}/statuses/{statusId}:
    put:
      summary: Update Status
      description: Updates a Kanban column status
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
        - name: statusId
          in: path
          required: true
          schema:
            type: string
          description: ID of the status to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                label:
                  type: string
                  example: "Code Review"
                color:
                  type: string
                  example: "#8b5cf6"
                order:
                  type: integer
                  example: 3
      responses:
        '200':
          description: Status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/KanbanStatus'
        '404':
          description: Task or status not found
        '400':
          description: Invalid request or not a task checklist

    delete:
      summary: Delete Status
      description: Deletes a Kanban column status. Items with this status will be moved to the first available status.
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
        - name: statusId
          in: path
          required: true
          schema:
            type: string
          description: ID of the status to delete
      responses:
        '200':
          description: Status deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '404':
          description: Task or status not found
        '400':
          description: Not a task checklist

  /tasks/{taskId}/items:
    post:
      summary: Create Task Item
      description: Creates a new item in a task checklist
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  example: "Implement user authentication"
                status:
                  type: string
                  default: "todo"
                  example: "todo"
                parentIndex:
                  type: string
                  description: Index path for creating nested items (e.g., "0" for child of first item, "0.1" for grandchild)
                  example: "0"
      responses:
        '200':
          description: Item created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
        '400':
          description: Invalid request
        '404':
          description: Task or parent item not found

  /tasks/{taskId}/items/{itemIndex}/status:
    put:
      summary: Update Item Status
      description: Changes an item's status (moves it between Kanban columns)
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
        - name: itemIndex
          in: path
          required: true
          schema:
            type: string
          description: Index path of the item (e.g., "0", "0.1", "2.0.1")
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  example: "in_progress"
      responses:
        '200':
          description: Item status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '400':
          description: Invalid request or item index
        '404':
          description: Task or item not found

  /tasks/{taskId}/items/{itemIndex}:
    delete:
      summary: Delete Task Item
      description: Deletes an item from a task checklist
      tags:
        - Tasks
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the task
        - name: itemIndex
          in: path
          required: true
          schema:
            type: string
          description: Index path of the item to delete (e.g., "0", "0.1", "2.0.1")
      responses:
        '200':
          description: Item deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '400':
          description: Invalid item index or not a task checklist
        '404':
          description: Task or item not found

  /user/{username}:
    get:
      summary: Get User Information
      description: Retrieves user information (full data if authenticated as user or admin, public data otherwise)
      tags:
        - Users
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
          description: Username to retrieve information for
      responses:
        '200':
          description: User information
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      username:
                        type: string
                      isAdmin:
                        type: boolean
                      createdAt:
                        type: string
                        format: date-time
                      lastLogin:
                        type: string
                        format: date-time
                      avatarUrl:
                        type: string
                      preferredTheme:
                        type: string
                      imageSyntax:
                        type: string
                      tableSyntax:
                        type: string
                      landingPage:
                        type: string
                      notesAutoSaveInterval:
                        type: integer
                      notesDefaultEditor:
                        type: string
                      notesDefaultMode:
                        type: string
                      pinnedLists:
                        type: array
                        items:
                          type: string
                      pinnedNotes:
                        type: array
                        items:
                          type: string
        '404':
          description: User not found

  /categories:
    get:
      summary: Get All Categories
      description: Retrieves all categories for notes and checklists
      tags:
        - Categories
      responses:
        '200':
          description: Categories organized by type
          content:
            application/json:
              schema:
                type: object
                properties:
                  categories:
                    type: object
                    properties:
                      notes:
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                            path:
                              type: string
                            count:
                              type: integer
                            level:
                              type: integer
                      checklists:
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                            path:
                              type: string
                            count:
                              type: integer
                            level:
                              type: integer

  /summary:
    get:
      summary: Get User Summary Statistics
      description: Retrieves comprehensive statistics about user content
      tags:
        - Statistics
      parameters:
        - name: username
          in: query
          schema:
            type: string
          description: Username to get summary for (admin only)
      responses:
        '200':
          description: User statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  summary:
                    type: object
                    properties:
                      username:
                        type: string
                      notes:
                        type: object
                        properties:
                          total:
                            type: integer
                          categories:
                            type: object
                            additionalProperties:
                              type: integer
                      checklists:
                        type: object
                        properties:
                          total:
                            type: integer
                          categories:
                            type: object
                            additionalProperties:
                              type: integer
                          types:
                            type: object
                            properties:
                              simple:
                                type: integer
                              task:
                                type: integer
                      items:
                        type: object
                        properties:
                          total:
                            type: integer
                          completed:
                            type: integer
                          pending:
                            type: integer
                          completionRate:
                            type: integer
                      tasks:
                        type: object
                        properties:
                          total:
                            type: integer
                          completed:
                            type: integer
                          inProgress:
                            type: integer
                          todo:
                            type: integer
                          completionRate:
                            type: integer

  /exports:
    post:
      summary: Request Data Export
      description: Initiates an export of user data
      tags:
        - Exports
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum: [all_checklists_notes, user_checklists_notes, all_users_data, whole_data_folder]
                  example: "all_checklists_notes"
                username:
                  type: string
                  description: Required for user_checklists_notes type
      responses:
        '200':
          description: Export initiated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  downloadUrl:
                    type: string
                    example: "/api/exports/all_checklists_notes_1678886400000.zip"

    get:
      summary: Get Export Progress
      description: Retrieves current export operation progress
      tags:
        - Exports
      responses:
        '200':
          description: Export progress
          content:
            application/json:
              schema:
                type: object
                properties:
                  progress:
                    type: integer
                    minimum: 0
                    maximum: 100
                    example: 75
                  message:
                    type: string
                    example: "Compressing files: 150/200 bytes"

  /admin/rebuild-index:
    post:
      summary: Rebuild Link Index
      description: Rebuilds internal link index for a user (admin only)
      tags:
        - Admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
              properties:
                username:
                  type: string
                  example: "fccview"
      responses:
        '200':
          description: Index rebuilt successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                  example: "Successfully rebuilt link index for fccview"
        '403':
          description: Admin access required

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
      description: API key obtained from Profile → Settings → API Key

  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          example: "Error message description"

    KanbanStatus:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the status
          example: "todo"
        label:
          type: string
          description: Display name for the status
          example: "To Do"
        color:
          type: string
          description: Optional color code for the status column
          example: "#3b82f6"
        order:
          type: integer
          description: Display order of the status column
          example: 0

    ChecklistItem:
      type: object
      properties:
        id:
          type: string
          description: Internal item ID
          example: "listId-1234567890"
        index:
          type: integer
          description: Position in the parent's items array
          example: 0
        text:
          type: string
          example: "Task 1"
        completed:
          type: boolean
          example: false
        status:
          type: string
          enum: [todo, in_progress, paused, completed]
          description: Only present for task-type checklists
        time:
          oneOf:
            - type: integer
              example: 0
            - type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                  startTime:
                    type: string
                    format: date-time
                  endTime:
                    type: string
                    format: date-time
                  duration:
                    type: integer
          description: Only present for task-type checklists
        children:
          type: array
          items:
            $ref: '#/components/schemas/ChecklistItem'
          description: Nested sub-items

  responses:
    UnauthorizedError:
      description: API key missing or invalid
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    ForbiddenError:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    BadRequestError:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
